[
    {
        "id_lesson": 279270,
        "steps": [
            {
                "id_step": 1074533,
                "text": {
                    "text": "Содержание урока\nВ этом уроке на каждом шаге нужно реализовать запросы на выборку для таблицы, в которой представлена информация о командировках сотрудников некоторой организации:\n\nВывести информацию о командировках тех сотрудников, фамилия которых заканчивается на букву «а».\nВывести в алфавитном порядке фамилии, имена и отчества тех сотрудников, которые были в командировке в Москве.\nДля каждого города посчитать, сколько раз сотрудники в нем были.\nВывести два города, в которых чаще всего были в командировках сотрудники.\nВывести информацию о длительности командировок сотрудников.\nВывести информацию о командировках сотрудника(ов), которые были самыми короткими по времени.\nВывести информацию о командировках, начало и конец которых относятся к одному месяцу.\nВывести номер месяца и количество командировок, первый день которых приходился на этот месяц.\nВывести сумму суточных  для командировок сотрудников.\nВывести фамилию с инициалами и общую сумму суточных, полученных за все командировки для тех сотрудников, которые были в командировках больше чем 3 раза.\n\nСтруктура и наполнение таблицы\nТаблица trip, в которой представлена информация о командировках сотрудников некоторой организации (фамилия сотрудника, город, куда он ездил, размер суточных, даты первого и последнего дня командировки) :\n\n[TABLE]\n\nПояснение\nТип DATE – позволяет описать дату в формате ГГГГ-ММ-ДД, например, 2020-02-02. При вставке данных в таблицу с помощью INSERT INTO ... VALUES значение даты заключается в кавычки.",
                    "tables": [
                        "{\"0\":{\"0\":\"trip_id\",\"1\":\"INT PRIMARY KEY AUTO_INCREMENT\",\"2\":\"1\",\"3\":\"2\",\"4\":\"3\",\"5\":\"4\",\"6\":\"5\",\"7\":\"6\",\"8\":\"7\",\"9\":\"8\",\"10\":\"9\",\"11\":\"10\",\"12\":\"11\",\"13\":\"12\",\"14\":\"13\",\"15\":\"14\",\"16\":\"15\",\"17\":\"16\",\"18\":\"17\",\"19\":\"18\",\"20\":\"19\",\"21\":\"20\"},\"1\":{\"0\":\"name\",\"1\":\"VARCHAR(30)\",\"2\":\"Баранов П.Е.\",\"3\":\"Абрамова К.А.\",\"4\":\"Семенов И.В.\",\"5\":\"Ильиных Г.Р.\",\"6\":\"Колесов С.П.\",\"7\":\"Баранов П.Е.\",\"8\":\"Абрамова К.А.\",\"9\":\"Лебедев Т.К.\",\"10\":\"Колесов С.П.\",\"11\":\"Семенов И.В.\",\"12\":\"Абрамова К.А.\",\"13\":\"Баранов П.Е.\",\"14\":\"Лебедев Т.К.\",\"15\":\"Семенов И.В.\",\"16\":\"Абрамова К.А.\",\"17\":\"Федорова А.Ю.\",\"18\":\"Колесов С.П.\",\"19\":\"Федорова А.Ю.\",\"20\":\"Абрамова К.А.\",\"21\":\"Баранов П.Е.\"},\"2\":{\"0\":\"city\",\"1\":\"VARCHAR(25)\",\"2\":\"Москва\",\"3\":\"Владивосток\",\"4\":\"Москва\",\"5\":\"Владивосток\",\"6\":\"Москва\",\"7\":\"Москва\",\"8\":\"Москва\",\"9\":\"Москва\",\"10\":\"Новосибирск\",\"11\":\"Санкт-Петербург\",\"12\":\"Москва\",\"13\":\"Новосибирск\",\"14\":\"Томск\",\"15\":\"Санкт-Петербург\",\"16\":\"Санкт-Петербург\",\"17\":\"Новосибирск\",\"18\":\"Новосибирск\",\"19\":\"Томск\",\"20\":\"Владивосток\",\"21\":\"Воронеж\"},\"3\":{\"0\":\"per_diem\",\"1\":\"DECIMAL(8,2)\",\"2\":\"700\",\"3\":\"450\",\"4\":\"700\",\"5\":\"450\",\"6\":\"700\",\"7\":\"700\",\"8\":\"700\",\"9\":\"700\",\"10\":\"450\",\"11\":\"700\",\"12\":\"700\",\"13\":\"450\",\"14\":\"450\",\"15\":\"700\",\"16\":\"700\",\"17\":\"450\",\"18\":\"450\",\"19\":\"450\",\"20\":\"450\",\"21\":\"450\"},\"4\":{\"0\":\"date_first\",\"1\":\"DATЕ\",\"2\":\"2020-01-12\",\"3\":\"2020-01-14\",\"4\":\"2020-01-23\",\"5\":\"2020-01-12\",\"6\":\"2020-02-01\",\"7\":\"2020-02-14\",\"8\":\"2020-02-23\",\"9\":\"2020-03-03\",\"10\":\"2020-02-27\",\"11\":\"2020-03-29\",\"12\":\"2020-04-06\",\"13\":\"2020-04-18\",\"14\":\"2020-05-20\",\"15\":\"2020-06-01\",\"16\":\"2020-05-28\",\"17\":\"2020-05-25\",\"18\":\"2020-06-03\",\"19\":\"2020-06-20\",\"20\":\"2020-07-02\",\"21\":\"2020-07-19\"},\"5\":{\"0\":\"date_last\",\"1\":\"DATE\",\"2\":\"2020-01-17\",\"3\":\"2020-01-27\",\"4\":\"2020-01-31\",\"5\":\"2020-02-02\",\"6\":\"2020-02-06\",\"7\":\"2020-02-22\",\"8\":\"2020-03-01\",\"9\":\"2020-03-06\",\"10\":\"2020-03-12\",\"11\":\"2020-04-05\",\"12\":\"2020-04-14\",\"13\":\"2020-05-04\",\"14\":\"2020-05-31\",\"15\":\"2020-06-03\",\"16\":\"2020-06-04\",\"17\":\"2020-06-04\",\"18\":\"2020-06-12\",\"19\":\"2020-06-26\",\"20\":\"2020-07-13\",\"21\":\"2020-07-25\"}}"
                    ]
                }
            },
            {
                "id_step": 1077024,
                "text": {
                    "text": "Задание\nВывести из таблицы trip информацию о командировках тех сотрудников, фамилия которых заканчивается на букву «а», в отсортированном по убыванию даты последнего дня командировки виде. В результат включить столбцы name, city, per_diem, date_first, date_last.\nРезультат\n+---------------+-----------------+----------+------------+------------+\n| name          | city            | per_diem | date_first | date_last  |\n+---------------+-----------------+----------+------------+------------+\n| Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| Федорова А.Ю. | Томск           | 450.00   | 2020-06-20 | 2020-06-26 |\n| Абрамова К.А. | Санкт-Петербург | 700.00   | 2020-05-28 | 2020-06-04 |\n| Федорова А.Ю. | Новосибирск     | 450.00   | 2020-05-25 | 2020-06-04 |\n| Абрамова К.А. | Москва          | 700.00   | 2020-04-06 | 2020-04-14 |\n| Абрамова К.А. | Москва          | 700.00   | 2020-02-23 | 2020-03-01 |\n| Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n+---------------+-----------------+----------+------------+------------+\n\nСвязанные шаги\n\nвыборка столбцов;\nусловие отбора;\nсортировка.\n\n\nСтруктура и наполнение таблицы trip\n+---------+---------------+-----------------+----------+------------+------------+\n| trip_id | name          | city            | per_diem | date_first | date_last  |\n+---------+---------------+-----------------+----------+------------+------------+\n| 1       | Баранов П.Е.  | Москва          | 700.00   | 2020-01-12 | 2020-01-17 |\n| 2       | Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n| 3       | Семенов И.В.  | Москва          | 700.00   | 2020-01-23 | 2020-01-31 |\n| 4       | Ильиных Г.Р.  | Владивосток     | 450.00   | 2020-01-12 | 2020-02-02 |\n| 5       | Колесов С.П.  | Москва          | 700.00   | 2020-02-01 | 2020-02-06 |\n| 6       | Баранов П.Е.  | Москва          | 700.00   | 2020-02-14 | 2020-02-22 |\n                          ...\n| 19      | Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| 20      | Баранов П.Е.  | Воронеж         | 450.00   | 2020-07-19 | 2020-07-25 |\n+---------+---------------+-----------------+----------+------------+------------+\n",
                    "tables": []
                }
            },
            {
                "id_step": 1032497,
                "text": {
                    "text": "Задание\nВывести в алфавитном порядке фамилии и инициалы тех сотрудников, которые были в командировке в Москве.\nРезультат\n+---------------+\n| name          |\n+---------------+\n| Абрамова К.А. |\n| Баранов П.Е.  |\n| Колесов С.П.  |\n| Лебедев Т.К.  |\n| Семенов И.В.  |\n+---------------+\n\nСвязанные шаги\n\nвыборка столбцов;\nуникальные записи;\nусловие отбора;\nсортировка.\n\n\nСтруктура и наполнение таблицы trip\n+---------+---------------+-----------------+----------+------------+------------+\n| trip_id | name          | city            | per_diem | date_first | date_last  |\n+---------+---------------+-----------------+----------+------------+------------+\n| 1       | Баранов П.Е.  | Москва          | 700.00   | 2020-01-12 | 2020-01-17 |\n| 2       | Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n| 3       | Семенов И.В.  | Москва          | 700.00   | 2020-01-23 | 2020-01-31 |\n| 4       | Ильиных Г.Р.  | Владивосток     | 450.00   | 2020-01-12 | 2020-02-02 |\n| 5       | Колесов С.П.  | Москва          | 700.00   | 2020-02-01 | 2020-02-06 |\n| 6       | Баранов П.Е.  | Москва          | 700.00   | 2020-02-14 | 2020-02-22 |\n                          ...\n| 19      | Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| 20      | Баранов П.Е.  | Воронеж         | 450.00   | 2020-07-19 | 2020-07-25 |\n+---------+---------------+-----------------+----------+------------+------------+\n",
                    "tables": []
                }
            },
            {
                "id_step": 1081070,
                "text": {
                    "text": "Задание\nДля каждого города посчитать, сколько раз сотрудники в нем были.  Информацию вывести в отсортированном в алфавитном порядке по названию городов. Вычисляемый столбец назвать Количество. \nРезультат\n+-----------------+------------+\n| city            | Количество |\n+-----------------+------------+\n| Владивосток     | 3          |\n| Воронеж         | 1          |\n| Москва          | 7          |\n| Новосибирск     | 4          |\n| Санкт-Петербург | 3          |\n| Томск           | 2          |\n+-----------------+------------+\n \n\nСвязанные шаги\n\nвыборка столбцов и их именование;\nвычисления для сгруппированных данных;\nсортировка.\n\n\nСтруктура и наполнение таблицы trip\n+---------+---------------+-----------------+----------+------------+------------+\n| trip_id | name          | city            | per_diem | date_first | date_last  |\n+---------+---------------+-----------------+----------+------------+------------+\n| 1       | Баранов П.Е.  | Москва          | 700.00   | 2020-01-12 | 2020-01-17 |\n| 2       | Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n| 3       | Семенов И.В.  | Москва          | 700.00   | 2020-01-23 | 2020-01-31 |\n| 4       | Ильиных Г.Р.  | Владивосток     | 450.00   | 2020-01-12 | 2020-02-02 |\n| 5       | Колесов С.П.  | Москва          | 700.00   | 2020-02-01 | 2020-02-06 |\n| 6       | Баранов П.Е.  | Москва          | 700.00   | 2020-02-14 | 2020-02-22 |\n                          ...\n| 19      | Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| 20      | Баранов П.Е.  | Воронеж         | 450.00   | 2020-07-19 | 2020-07-25 |\n+---------+---------------+-----------------+----------+------------+------------+\n",
                    "tables": []
                }
            },
            {
                "id_step": 1081883,
                "text": {
                    "text": "Оператор LIMIT\nДля ограничения вывода записей в SQL используется оператор LIMIT , после которого указывается количество строк.  Результирующая таблица будет иметь количество строк не более указанного после LIMIT. LIMIT размещается после раздела ORDER BY.\nКак правило, этот оператор используется, чтобы отобрать заданное количество отсортированных строк результата запроса. \nПример\nВывести информацию о первой  командировке из таблицы trip. \"Первой\" считать командировку с самой ранней датой начала.\nЗапрос:\nSELECT *\nFROM trip\nORDER BY  date_first\nLIMIT 1;\nРезультат:\n+---------+--------------+--------+----------+------------+------------+\n| trip_id | name         | city   | per_diem | date_first | date_last  |\n+---------+--------------+--------+----------+------------+------------+\n| 1       | Баранов П.Е. | Москва | 700.00   | 2020-01-12 | 2020-01-17 |\n+---------+--------------+--------+----------+------------+------------+\nВажно. Оператор LIMIT нужно использовать очень осторожно. Например, если бы в таблице trip было несколько командировок с одинаковой датой начала, этот запрос работал бы НЕВЕРНО. Это связано с тем, что заранее не известно точное значение таких командировок.\nЗадание\nВывести два города, в которых чаще всего были в командировках сотрудники. Вычисляемый столбец назвать Количество.\nРезультат\n+-------------+------------+\n| city        | Количество |\n+-------------+------------+\n| Москва      | 7          |\n| Новосибирск | 4          |\n+-------------+------------+\n\nСвязанные шаги\n\nвыборка столбцов и их именование;\nвычисления для сгруппированных данных;\nсортировка.\n\n\nСтруктура и наполнение таблицы trip\n+---------+---------------+-----------------+----------+------------+------------+\n| trip_id | name          | city            | per_diem | date_first | date_last  |\n+---------+---------------+-----------------+----------+------------+------------+\n| 1       | Баранов П.Е.  | Москва          | 700.00   | 2020-01-12 | 2020-01-17 |\n| 2       | Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n| 3       | Семенов И.В.  | Москва          | 700.00   | 2020-01-23 | 2020-01-31 |\n| 4       | Ильиных Г.Р.  | Владивосток     | 450.00   | 2020-01-12 | 2020-02-02 |\n| 5       | Колесов С.П.  | Москва          | 700.00   | 2020-02-01 | 2020-02-06 |\n| 6       | Баранов П.Е.  | Москва          | 700.00   | 2020-02-14 | 2020-02-22 |\n                          ...\n| 19      | Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| 20      | Баранов П.Е.  | Воронеж         | 450.00   | 2020-07-19 | 2020-07-25 |\n+---------+---------------+-----------------+----------+------------+------------+\n",
                    "tables": []
                }
            },
            {
                "id_step": 1078151,
                "text": {
                    "text": "Задание\nВывести информацию о командировках во все города кроме Москвы и Санкт-Петербурга (фамилии и инициалы сотрудников, город ,  длительность командировки в днях, при этом первый и последний день относится к периоду командировки). Последний столбец назвать Длительность. Информацию вывести в упорядоченном по убыванию длительности поездки, а потом по убыванию названий городов (в обратном алфавитном порядке).\nНемного теории\nДля вычитания двух дат используется функция DATEDIFF(дата_1, дата_2), результатом которой является количество дней между дата_1 и дата_2. Например,\nDATEDIFF('2020-04-01', '2020-03-28')=4\n\nDATEDIFF('2020-05-09','2020-05-01')=8\n\nDATEDIFF(date_last, date_first)\nПояснение\nУвеличьте разницу на 1, чтобы включить первый день командировки.\n\nТекст задания (чтобы не прокручивать страницу):\n\nВывести информацию о командировках во все города кроме Москвы и Санкт-Петербурга (фамилии и инициалы сотрудников, город ,  длительность командировки в днях, при этом первый и последний день относится к периоду командировки). Последний столбец назвать Длительность. Информацию вывести в упорядоченном по убыванию длительности поездки, а потом по убыванию названий городов (в обратном алфавитном порядке).\n\nРезультат\n+---------------+-------------+--------------+\n| name          | city        | Длительность |\n+---------------+-------------+--------------+\n| Ильиных Г.Р.  | Владивосток | 22           |\n| Баранов П.Е.  | Новосибирск | 17           |\n| Колесов С.П.  | Новосибирск | 15           |\n| Абрамова К.А. | Владивосток | 14           |\n| Лебедев Т.К.  | Томск       | 12           |\n| Абрамова К.А. | Владивосток | 12           |\n| Федорова А.Ю. | Новосибирск | 11           |\n| Колесов С.П.  | Новосибирск | 10           |\n| Федорова А.Ю. | Томск       | 7            |\n| Баранов П.Е.  | Воронеж     | 7            |\n+---------------+-------------+--------------+\n\nСвязанные шаги\n\nвыборка столбцов и их именование;\nусловие отбора (шаг, шаг);\nсортировка.\n\n\nСтруктура и наполнение таблицы trip\n+---------+---------------+-----------------+----------+------------+------------+\n| trip_id | name          | city            | per_diem | date_first | date_last  |\n+---------+---------------+-----------------+----------+------------+------------+\n| 1       | Баранов П.Е.  | Москва          | 700.00   | 2020-01-12 | 2020-01-17 |\n| 2       | Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n| 3       | Семенов И.В.  | Москва          | 700.00   | 2020-01-23 | 2020-01-31 |\n| 4       | Ильиных Г.Р.  | Владивосток     | 450.00   | 2020-01-12 | 2020-02-02 |\n| 5       | Колесов С.П.  | Москва          | 700.00   | 2020-02-01 | 2020-02-06 |\n| 6       | Баранов П.Е.  | Москва          | 700.00   | 2020-02-14 | 2020-02-22 |\n                          ...\n| 19      | Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| 20      | Баранов П.Е.  | Воронеж         | 450.00   | 2020-07-19 | 2020-07-25 |\n+---------+---------------+-----------------+----------+------------+------------+\n",
                    "tables": []
                }
            },
            {
                "id_step": 1080693,
                "text": {
                    "text": "Задание\nВывести информацию о командировках сотрудника(ов), которые были самыми короткими по времени. В результат включить столбцы name, city, date_first, date_last.\nПояснение\nИспользуйте вложенный запрос, чтобы найти длительность самой короткой командировки. \n\nРезультат\n+--------------+-----------------+------------+------------+\n| name         | city            | date_first | date_last  |\n+--------------+-----------------+------------+------------+\n| Семенов И.В. | Санкт-Петербург | 2020-06-01 | 2020-06-03 |\n+--------------+-----------------+------------+------------+\n\nСвязанные шаги\n\nвыборка столбцов;\nвложенный запрос в WHERE;\nвычитание дат;\nгрупповые вычисления по всей таблице;\nгрупповые функции.\n\n\nСтруктура и наполнение таблицы trip\n+---------+---------------+-----------------+----------+------------+------------+\n| trip_id | name          | city            | per_diem | date_first | date_last  |\n+---------+---------------+-----------------+----------+------------+------------+\n| 1       | Баранов П.Е.  | Москва          | 700.00   | 2020-01-12 | 2020-01-17 |\n| 2       | Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n| 3       | Семенов И.В.  | Москва          | 700.00   | 2020-01-23 | 2020-01-31 |\n| 4       | Ильиных Г.Р.  | Владивосток     | 450.00   | 2020-01-12 | 2020-02-02 |\n| 5       | Колесов С.П.  | Москва          | 700.00   | 2020-02-01 | 2020-02-06 |\n| 6       | Баранов П.Е.  | Москва          | 700.00   | 2020-02-14 | 2020-02-22 |\n                          ...\n| 19      | Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| 20      | Баранов П.Е.  | Воронеж         | 450.00   | 2020-07-19 | 2020-07-25 |\n+---------+---------------+-----------------+----------+------------+------------+\n",
                    "tables": []
                }
            },
            {
                "id_step": 1080813,
                "text": {
                    "text": "Задание\nВывести информацию о командировках, начало и конец которых относятся к одному месяцу (год может быть любой). В результат включить столбцы name, city, date_first, date_last. Строки отсортировать сначала  в алфавитном порядке по названию города, а затем по фамилии сотрудника .\nНемного теории\nДля того, чтобы выделить номер месяца из даты используется функция MONTH(дата).\nНапример, MONTH('2020-04-12') = 4.\nЕсли определяется месяц для  значений столбца date_first, то используется запись MONTH(date_first)\nРезультат\n+---------------+-----------------+------------+------------+\n| name          | city            | date_first | date_last  |\n+---------------+-----------------+------------+------------+\n| Абрамова К.А. | Владивосток     | 2020-01-14 | 2020-01-27 |\n| Абрамова К.А. | Владивосток     | 2020-07-02 | 2020-07-13 |\n| Баранов П.Е.  | Воронеж         | 2020-07-19 | 2020-07-25 |\n| Абрамова К.А. | Москва          | 2020-04-06 | 2020-04-14 |\n| Баранов П.Е.  | Москва          | 2020-01-12 | 2020-01-17 |\n| Баранов П.Е.  | Москва          | 2020-02-14 | 2020-02-22 |\n| Колесов С.П.  | Москва          | 2020-02-01 | 2020-02-06 |\n| Лебедев Т.К.  | Москва          | 2020-03-03 | 2020-03-06 |\n| Семенов И.В.  | Москва          | 2020-01-23 | 2020-01-31 |\n| Колесов С.П.  | Новосибирск     | 2020-06-03 | 2020-06-12 |\n| Семенов И.В.  | Санкт-Петербург | 2020-06-01 | 2020-06-03 |\n| Лебедев Т.К.  | Томск           | 2020-05-20 | 2020-05-31 |\n| Федорова А.Ю. | Томск           | 2020-06-20 | 2020-06-26 |\n+---------------+-----------------+------------+------------+\n\nСвязанные шаги\n\nвыборка столбцов;\nусловие отбора;\nсортировка.\n\n\nСтруктура и наполнение таблицы trip\n+---------+---------------+-----------------+----------+------------+------------+\n| trip_id | name          | city            | per_diem | date_first | date_last  |\n+---------+---------------+-----------------+----------+------------+------------+\n| 1       | Баранов П.Е.  | Москва          | 700.00   | 2020-01-12 | 2020-01-17 |\n| 2       | Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n| 3       | Семенов И.В.  | Москва          | 700.00   | 2020-01-23 | 2020-01-31 |\n| 4       | Ильиных Г.Р.  | Владивосток     | 450.00   | 2020-01-12 | 2020-02-02 |\n| 5       | Колесов С.П.  | Москва          | 700.00   | 2020-02-01 | 2020-02-06 |\n| 6       | Баранов П.Е.  | Москва          | 700.00   | 2020-02-14 | 2020-02-22 |\n                          ...\n| 19      | Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| 20      | Баранов П.Е.  | Воронеж         | 450.00   | 2020-07-19 | 2020-07-25 |\n+---------+---------------+-----------------+----------+------------+------------+\n",
                    "tables": []
                }
            },
            {
                "id_step": 1081083,
                "text": {
                    "text": "Задание\nВывести название месяца и количество командировок для каждого месяца. Считаем, что командировка относится к некоторому месяцу, если она началась в этом месяце. Информацию вывести сначала в отсортированном по убыванию количества, а потом в алфавитном порядке по названию месяца виде. Название столбцов – Месяц и Количество.\nНемного теории\n\nДля того, чтобы выделить название месяца из даты используется функция MONTHNAME(дата), которая возвращает название месяца на английском языке для указанной даты. Например, MONTHNAME('2020-04-12')='April'.\nЕсли группировка осуществляется по вычисляемому столбцу (в данном случае «вычисляется» название месяца), то после GROUP BYможно указать как вычисляемое выражение, так и имя столбца, заданное с помощью AS. Важно отметить, что последний вариант (указать имя столбца)  нарушает стандарт по порядку выполнения запросов, но иногда может встречаться на реальных платформах.\n\nРезультат\n+----------+------------+\n| Месяц    | Количество |\n+----------+------------+\n| February | 4          |\n| January  | 4          |\n| June     | 3          |\n| May      | 3          |\n| April    | 2          |\n| July     | 2          |\n| March    | 2          |\n+----------+------------+\n\nСвязанные шаги\n\nвыборка столбцов и их именование;\nвычисления для сгруппированных данных;\nсортировка.\n\n\nСтруктура и наполнение таблицы trip\n+---------+---------------+-----------------+----------+------------+------------+\n| trip_id | name          | city            | per_diem | date_first | date_last  |\n+---------+---------------+-----------------+----------+------------+------------+\n| 1       | Баранов П.Е.  | Москва          | 700.00   | 2020-01-12 | 2020-01-17 |\n| 2       | Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n| 3       | Семенов И.В.  | Москва          | 700.00   | 2020-01-23 | 2020-01-31 |\n| 4       | Ильиных Г.Р.  | Владивосток     | 450.00   | 2020-01-12 | 2020-02-02 |\n| 5       | Колесов С.П.  | Москва          | 700.00   | 2020-02-01 | 2020-02-06 |\n| 6       | Баранов П.Е.  | Москва          | 700.00   | 2020-02-14 | 2020-02-22 |\n                          ...\n| 19      | Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| 20      | Баранов П.Е.  | Воронеж         | 450.00   | 2020-07-19 | 2020-07-25 |\n+---------+---------------+-----------------+----------+------------+------------+\n",
                    "tables": []
                }
            },
            {
                "id_step": 1080747,
                "text": {
                    "text": "Задание\nВывести сумму суточных (произведение количества дней командировки и размера суточных) для командировок, первый день которых пришелся на февраль или март 2020 года. Значение суточных для каждой командировки занесено в столбец per_diem. Вывести фамилию и инициалы сотрудника, город, первый день командировки и сумму суточных. Последний столбец назвать Сумма. Информацию отсортировать сначала  в алфавитном порядке по фамилиям сотрудников, а затем по убыванию суммы суточных.\nПояснение\n1. В SQL есть функции, которые позволяют выделить часть даты: день(DAY()), месяц (MONTH()), год(YEAR()) . Например:\nDAY('2020-02-01') = 1\nMONTH('2020-02-01') = 2\nYEAR('2020-02-01') = 2020\n2. Количество дней командировки вычисляется как разница между датами последнего и первого дня командировки плюс 1.\n\nРезультат\n+---------------+-----------------+------------+---------+\n| name          | city            | date_first | Сумма   |\n+---------------+-----------------+------------+---------+\n| Абрамова К.А. | Москва          | 2020-02-23 | 5600.00 |\n| Баранов П.Е.  | Москва          | 2020-02-14 | 6300.00 |\n| Колесов С.П.  | Новосибирск     | 2020-02-27 | 6750.00 |\n| Колесов С.П.  | Москва          | 2020-02-01 | 4200.00 |\n| Лебедев Т.К.  | Москва          | 2020-03-03 | 2800.00 |\n| Семенов И.В.  | Санкт-Петербург | 2020-03-29 | 5600.00 |\n+---------------+-----------------+------------+---------+\n\nСвязанные шаги\n\nвыборка столбцов и их именование;\nвычисления в SELECT;\nвычитание дат;\nвыделение номера месяца из даты;\nусловие отбора;\nсортировка.\n\n\nСтруктура и наполнение таблицы trip\n+---------+---------------+-----------------+----------+------------+------------+\n| trip_id | name          | city            | per_diem | date_first | date_last  |\n+---------+---------------+-----------------+----------+------------+------------+\n| 1       | Баранов П.Е.  | Москва          | 700.00   | 2020-01-12 | 2020-01-17 |\n| 2       | Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n| 3       | Семенов И.В.  | Москва          | 700.00   | 2020-01-23 | 2020-01-31 |\n| 4       | Ильиных Г.Р.  | Владивосток     | 450.00   | 2020-01-12 | 2020-02-02 |\n| 5       | Колесов С.П.  | Москва          | 700.00   | 2020-02-01 | 2020-02-06 |\n| 6       | Баранов П.Е.  | Москва          | 700.00   | 2020-02-14 | 2020-02-22 |\n                          ...\n| 19      | Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| 20      | Баранов П.Е.  | Воронеж         | 450.00   | 2020-07-19 | 2020-07-25 |\n+---------+---------------+-----------------+----------+------------+------------+\n",
                    "tables": []
                }
            },
            {
                "id_step": 1080788,
                "text": {
                    "text": "Задание\nВывести фамилию с инициалами и общую сумму суточных, полученных за все командировки для тех сотрудников, которые были в командировках больше чем 3 раза, в отсортированном по убыванию сумм суточных виде. Последний столбец назвать Сумма.\nТолько для этого задания изменена строка таблицы trip:\n\n[TABLE]\n\nРезультат\n+---------------+----------+\n| name          | Сумма    |\n+---------------+----------+\n| Абрамова К.А. | 29200.00 |\n| Баранов П.Е.  | 21300.00 |\n+---------------+----------+\n\nСвязанные шаги\n\nвыборка столбцов;\nвычисления в SELECT;\nвычисления над сгруппированными данными;\nусловие отбора в запросах группировки;\nвложенные запросы;\nсортировка.\n\n\nСтруктура и наполнение таблицы trip\n+---------+---------------+-----------------+----------+------------+------------+\n| trip_id | name          | city            | per_diem | date_first | date_last  |\n+---------+---------------+-----------------+----------+------------+------------+\n| 1       | Баранов П.Е.  | Москва          | 700.00   | 2020-01-12 | 2020-01-17 |\n| 2       | Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |\n| 3       | Семенов И.В.  | Москва          | 700.00   | 2020-01-23 | 2020-01-31 |\n| 4       | Ильиных Г.Р.  | Владивосток     | 450.00   | 2020-01-12 | 2020-03-02 |\n| 5       | Колесов С.П.  | Москва          | 700.00   | 2020-02-01 | 2020-02-06 |\n| 6       | Баранов П.Е.  | Москва          | 700.00   | 2020-02-14 | 2020-02-22 |\n                          ...\n| 19      | Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |\n| 20      | Баранов П.Е.  | Воронеж         | 450.00   | 2020-07-19 | 2020-07-25 |\n+---------+---------------+-----------------+----------+------------+------------+\n",
                    "tables": [
                        "{\"0\":{\"0\":4},\"1\":{\"0\":\"Ильиных Г.Р.\"},\"2\":{\"0\":\"Владивосток\"},\"3\":{\"0\":450},\"4\":{\"0\":\"2020-01-12\"},\"5\":{\"0\":\"2020-03-02\"}}"
                    ]
                }
            }
        ]
    }
]