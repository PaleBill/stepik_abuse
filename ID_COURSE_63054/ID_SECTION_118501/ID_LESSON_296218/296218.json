[
    {
        "id_lesson": 296218,
        "steps": [
            {
                "id_step": 1111729,
                "text": {
                    "text": "Задания, придуманные пользователями. Отмечайте в комментариях понравившиеся запросы!\nЗа эти запросы баллы не начисляются, они являются необязательными для получения сертификата по курсу.",
                    "tables": []
                }
            },
            {
                "id_step": 1214534,
                "text": {
                    "text": "Задание\nавтор - Даниил Карасев\nПровести аналитику по трем ценовым категориям (до 600 руб, от 600 руб до 700 руб, свыше 700 руб) и вывести среднюю цену  книги, общую стоимость остатков книг  в этой ценовой позиции и количество позиций. Среднюю цену и стоимость округлить до двух знаков после запятой. Информацию отсортировать по возрастанию нижней границы ценовой категории.\nСтруктура таблицы:\n\nДля реализации этого запроса создадим вспомогательную таблицу stat, в которой будут храниться ценовые категории (первая ценовая категория - цены  больше или равны 0 и меньше 600, вторая - больше или равны 600 и меньше 700 и т.д.):\n\n[TABLE]\n\nИспользование такой таблицы позволит анализировать разные ценовые категории, не изменяя запрос. В таблице можно указать любое количество категорий и любые границы.\nРезультат (таблица stat уже создана):\n+-----------+-----------+--------------+-----------+------------+\n| beg_range | end_range | Средняя_цена | Стоимость | Количество |\n+-----------+-----------+--------------+-----------+------------+\n| 0         | 600       | 493.67       | 12107.50  | 3          |\n| 600       | 700       | 660.50       | 11762.97  | 2          |\n| 700       | 10000     | 799.01       | 2397.03   | 1          |\n+-----------+-----------+--------------+-----------+------------+\nПояснение (один из вариантов решения).\nМожно сначала реализовать вложенный запрос, в котором для каждой книги вывести ценовой интервал, к которому она относится, результат:\n+-----------+-----------+--------+--------+\n| beg_range | end_range | price  | amount |\n+-----------+-----------+--------+--------+\n| 600       | 700       | 670.99 | 3      |\n| 0         | 600       | 540.50 | 5      |\n| 0         | 600       | 460.00 | 10     |\n| 700       | 10000     | 799.01 | 3      |\n| 0         | 600       | 480.50 | 10     |\n| 600       | 700       | 650.00 | 15     |\n+-----------+-----------+--------+--------+\n В основном запросе выполнить вычисления с помощью групповых функций.\nТекст задания (чтобы не прокручивать страницу) :\n\nПровести аналитику по трем ценовым категориям (до 600 руб, от 600 руб до 700 руб, свыше 700 руб) и вывести среднюю цену  книги, общую стоимость остатков книг  в этой ценовой позиции и количество позиций. Среднюю цену и стоимость округлить до двух знаков после запятой. Информацию отсортировать по возрастанию нижней границы ценовой категории.\n",
                    "tables": [
                        "{\"0\":{\"0\":\"beg_range\",\"1\":\"int\",\"2\":\"0\",\"3\":\"600\",\"4\":\"700\"},\"1\":{\"0\":\"end_range\",\"1\":\"INT\",\"2\":\"600\",\"3\":\"700\",\"4\":\"10000\"}}"
                    ]
                }
            },
            {
                "id_step": 1217781,
                "text": {
                    "text": "Задание\nавтор - Анатолий Алексеев\nВывести всю информацию из таблицы book, упорядоченную по возрастанию длины названия книги.\n Структура таблицы:\n\nРезультат:\n+---------+-----------------------+------------------+--------+--------+\n| book_id | title                 | author           | price  | amount |\n+---------+-----------------------+------------------+--------+--------+\n| 3       | Идиот                 | Достоевский Ф.М. | 460.00 | 10     |\n| 5       | Игрок                 | Достоевский Ф.М. | 480.50 | 10     |\n| 2       | Белая гвардия         | Булгаков М.А.    | 540.50 | 5      |\n| 4       | Братья Карамазовы     | Достоевский Ф.М. | 799.01 | 3      |\n| 1       | Мастер и Маргарита    | Булгаков М.А.    | 670.99 | 3      |\n| 6       | Стихотворения и поэмы | Есенин С.А.      | 650.00 | 15     |\n+---------+-----------------------+------------------+--------+--------+\nПояснение. \n\nДля вычисления длины тестовой строки используется функция length().\nСортировку можно осуществлять не только по названию столбца, но и по любому выражению.\n\nТекст задания (чтобы не прокручивать страницу) : \n\nВывести всю информацию из таблицы book, упорядоченную по возрастанию длины названия книги.\n",
                    "tables": []
                }
            },
            {
                "id_step": 1225198,
                "text": {
                    "text": " Задание\nавтор - Анатолий Алексеев\nУдалить из таблиц book и supplyкниги, цены которых заканчиваются на 99 копеек. Например, книга с ценой 670.99 должна быть удалена.\nСтруктура таблиц:\n\nРезультат:\nAffected rows: 1\n\nQuery result:\n+---------+-----------------------+------------------+--------+--------+\n| book_id | title                 | author           | price  | amount |\n+---------+-----------------------+------------------+--------+--------+\n| 2       | Белая гвардия         | Булгаков М.А.    | 540.50 | 5      |\n| 3       | Идиот                 | Достоевский Ф.М. | 460.00 | 10     |\n| 4       | Братья Карамазовы     | Достоевский Ф.М. | 799.01 | 3      |\n| 5       | Игрок                 | Достоевский Ф.М. | 480.50 | 10     |\n| 6       | Стихотворения и поэмы | Есенин С.А.      | 650.00 | 15     |\n+---------+-----------------------+------------------+--------+--------+\nAffected rows: 5\n\nAffected rows: 1\n\nQuery result:\n+-----------+----------------+------------------+--------+--------+\n| supply_id | title          | author           | price  | amount |\n+-----------+----------------+------------------+--------+--------+\n| 2         | Черный человек | Есенин С.А.      | 570.20 | 6      |\n| 3         | Белая гвардия  | Булгаков М.А.    | 540.50 | 7      |\n| 4         | Идиот          | Достоевский Ф.М. | 360.80 | 3      |\n+-----------+----------------+------------------+--------+--------+\nAffected rows: 3\nТекст задания (чтобы не прокручивать страницу) : \n\nУдалить из таблиц book и supplyкниги, цены которых заканчиваются на 99 копеек. Например, книга с ценой 670.99 должна быть удалена.\n",
                    "tables": []
                }
            },
            {
                "id_step": 1239713,
                "text": {
                    "text": " Задание\nавтор - Елена Петухова\nСнизить цены книг, цена которых больше 600 рублей, на 20%. Вывести информацию о книгах, скидку (столбец sale_20) и цену книги со скидкой (price_sale).  Результаты округлить до двух знаков после запятой. Для тех книг, на которые скидка не действует, в последних двух столбцах вывести символ  \"-\".  Отсортировать информацию сначала по фамилии автора, а потом по названию книги.\nСтруктура таблицы:\n\nРезультат:\n+------------------+-----------------------+--------+--------+---------+------------+\n| author           | title                 | price  | amount | sale_20 | price_sale |\n+------------------+-----------------------+--------+--------+---------+------------+\n| Булгаков М.А.    | Белая гвардия         | 540.50 | 5      | -       | -          |\n| Булгаков М.А.    | Мастер и Маргарита    | 670.99 | 3      | 134.20  | 536.79     |\n| Достоевский Ф.М. | Братья Карамазовы     | 799.01 | 3      | 159.80  | 639.21     |\n| Достоевский Ф.М. | Игрок                 | 480.50 | 10     | -       | -          |\n| Достоевский Ф.М. | Идиот                 | 460.00 | 10     | -       | -          |\n| Есенин С.А.      | Стихотворения и поэмы | 650.00 | 15     | 130.00  | 520.00     |\n+------------------+-----------------------+--------+--------+---------+------------+\nТекст задания (чтобы не прокручивать страницу) : \n\nСнизить цены книг, цена которых больше 600 рублей, на 20%. Вывести информацию о книгах, скидку (столбец sale_20) и цену книги со скидкой (price_sale).  Результаты округлить до двух знаков после запятой. Для тех книг, на которые скидка не действует, в последних двух столбцах вывести символ  \"-\".  Отсортировать информацию сначала по фамилии автора, а потом по названию книги.\n",
                    "tables": []
                }
            },
            {
                "id_step": 1243824,
                "text": {
                    "text": " Задание\nавтор - Елена Голяева\nВывести авторов и суммарную стоимость их книг, если хотя бы одна их книга имеет цену выше средней по складу. Средняя цена рассчитывается как простое среднее, с помощью avg(). Информацию отсортировать по убыванию суммарной стоимости.\nСтруктура таблицы:\n\nРезультат:\n+------------------+-----------+\n| author           | Стоимость |\n+------------------+-----------+\n| Достоевский Ф.М. | 11802.03  |\n| Есенин С.А.      | 9750.00   |\n| Булгаков М.А.    | 4715.47   |\n+------------------+-----------+\nТекст задания (чтобы не прокручивать страницу) : \n\nВывести авторов и суммарную стоимость их книг, если хотя бы одна их книга имеет цену выше средней по складу. Средняя цена рассчитывается как простое среднее, с помощью avg(). Информацию отсортировать по убыванию суммарной стоимости.\n",
                    "tables": []
                }
            },
            {
                "id_step": 1258711,
                "text": {
                    "text": " Задание\nавтор - Максим\nВывести автора, название, количество, цену (Розничная_цена). Для тех книг количество которых больше или равно 10, отобразить оптовую скидку 15% (Скидка), округлить до двух знаков после запятой и вывести оптовую цену с учетом скидки -15% (Оптовая_цена). Все атрибуты перевести на русский язык. Отсортировать по автору и названию книги.\nСтруктура таблицы:\n\nРезультат:\n+------------------+-----------------------+------------+----------------+--------+--------------+\n| Автор            | Название_книги        | Количество | Розничная_цена | Скидка | Оптовая_цена |\n+------------------+-----------------------+------------+----------------+--------+--------------+\n| Булгаков М.А.    | Белая гвардия         | 5          | 540.50         | 0      | 540.50       |\n| Булгаков М.А.    | Мастер и Маргарита    | 3          | 670.99         | 0      | 670.99       |\n| Достоевский Ф.М. | Братья Карамазовы     | 3          | 799.01         | 0      | 799.01       |\n| Достоевский Ф.М. | Игрок                 | 10         | 480.50         | 15     | 408.43       |\n| Достоевский Ф.М. | Идиот                 | 10         | 460.00         | 15     | 391.00       |\n| Есенин С.А.      | Стихотворения и поэмы | 15         | 650.00         | 15     | 552.50       |\n+------------------+-----------------------+------------+----------------+--------+--------------+\nТекст задания (чтобы не прокручивать страницу) : \n\nВывести автора, название, количество, цену (Розничная_цена). Для тех книг количество которых больше или равно 10, отобразить оптовую скидку 15% (Скидка), округлить до двух знаков после запятой и вывести оптовую цену с учетом скидки -15% (Оптовая_цена). Все атрибуты перевести на русский язык. Отсортировать по автору и названию книги.\n",
                    "tables": []
                }
            },
            {
                "id_step": 1261616,
                "text": {
                    "text": " Задание\nавтор - Артём Чепк\nВывести авторов, у которых есть книги со стоимостью более 500 и количеством более 1 шт на складе. Учитывать книги только тех авторов, у которых не менее 2-х произведений на складе. Вывести автора, количество различных произведений автора, минимальную цену и количество книг на складе. Информацию отсортировать по фамилии автора в алфавитном порядке.\nСтруктура таблицы:\n\nРезультат:\n+------------------+-------------------------+------------------+------------+\n| author           | Количество_произведений | Минимальная_цена | Число_книг |\n+------------------+-------------------------+------------------+------------+\n| Булгаков М.А.    | 2                       | 540.50           | 8          |\n| Достоевский Ф.М. | 3                       | 460.00           | 23         |\n+------------------+-------------------------+------------------+------------+\nТекст задания (чтобы не прокручивать страницу) : \n\nВывести авторов, у которых есть книги со стоимостью более 500 и количеством более 1 шт на складе. Учитывать книги только тех авторов, у которых не менее 2-х произведений на складе. Вывести автора, количество различных произведений автора, минимальную цену и количество книг на складе. Информацию отсортировать по фамилии автора в алфавитном порядке.\n",
                    "tables": []
                }
            }
        ]
    }
]